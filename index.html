<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover">
<title>Remote Desktop</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<canvas id="c"></canvas>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-container">
    <div class="loading-spinner">
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
    </div>
    <div class="loading-status" id="loadingStatus">Connecting...</div>
    <div class="loading-substatus" id="loadingSubstatus">Initializing WebRTC</div>
    <div class="loading-stages">
      <div class="stage" id="stageIce"><span class="stage-dot"></span><span class="stage-label">ICE</span></div>
      <div class="stage" id="stageSignal"><span class="stage-dot"></span><span class="stage-label">Signal</span></div>
      <div class="stage" id="stageConnect"><span class="stage-dot"></span><span class="stage-label">Connect</span></div>
      <div class="stage" id="stageAuth"><span class="stage-dot"></span><span class="stage-label">Auth</span></div>
      <div class="stage" id="stageStream"><span class="stage-dot"></span><span class="stage-label">Stream</span></div>
    </div>
  </div>
</div>

<!-- Connection Modal -->
<div class="auth-overlay" id="connectOverlay">
  <div class="auth-container">
    <div class="auth-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </div>
    <h2 class="auth-title">Connect</h2>
    <p class="auth-subtitle">Enter the server address</p>

    <div class="auth-field">
      <label class="auth-label" for="localUrlInput">Server URL</label>
      <input type="text" id="localUrlInput" class="auth-input" placeholder="http://192.168.1.100:6060" spellcheck="false">
    </div>
    <button class="auth-btn" id="connectLocalBtn">Connect</button>

    <p class="auth-error" id="connectError"></p>
  </div>
</div>

<!-- Authentication Modal -->
<div class="auth-overlay" id="authOverlay">
  <div class="auth-container">
    <div class="auth-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
      </svg>
    </div>
    <h2 class="auth-title">Authentication</h2>
    <p class="auth-subtitle">Enter credentials to connect</p>
    <div class="auth-field">
      <label class="auth-label" for="usernameInput">Username</label>
      <input type="text" id="usernameInput" class="auth-input" maxlength="32" autocomplete="username" placeholder="Username" spellcheck="false">
    </div>
    <div class="auth-field">
      <label class="auth-label" for="pinInput">PIN</label>
      <input type="text" id="pinInput" class="auth-input auth-input-pin" maxlength="6" inputmode="numeric" pattern="[0-9]*" autocomplete="off" placeholder="------">
    </div>
    <p class="auth-error" id="authError"></p>
    <button class="auth-btn" id="authSubmit">Connect</button>
  </div>
</div>

<button class="edge" id="edge"></button>
<div class="bk" id="bk"></div>
<div class="pnl" id="pnl">
  <div class="ph"><span class="pt">Settings</span><button class="px" id="pnlX">Ã—</button></div>
  <div class="pc">
    <div class="sec fss">
      <button class="btn" id="fs"><svg id="fsi" viewBox="0 0 24 24"><path id="fsp"/></svg><span id="fst">Fullscreen</span></button>
    </div>
    <div class="sec">
      <div class="sl">Audio</div>
      <button class="btn bf" id="aBtn"><svg viewBox="0 0 24 24"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07M19.07 4.93a10 10 0 0 1 0 14.14"/></svg><span id="aTxt">Enable</span></button>
      <div class="fst" id="aSt"><span class="fd"></span><span id="aStT">Tap to enable audio</span></div>
    </div>
    <div class="sec tch">
      <div class="sl">Touch</div>
      <div class="fst tc on"><span class="fd"></span><span id="tStT">Trackpad mode</span></div>
      <div class="tms">
        <label class="tmo"><input type="radio" name="tm" value="trackpad" checked><div class="tmr"></div><span class="tmt">Trackpad</span></label>
        <label class="tmo"><input type="radio" name="tm" value="direct"><div class="tmr"></div><span class="tmt">Direct</span></label>
      </div>
    </div>
    <div class="sec">
      <div class="sl">Capture</div>
      <div class="sw">
        <span class="sla">Monitor</span>
        <select class="sel" id="monSel"><option value="0">Waiting...</option></select>
      </div>
      <div class="sw">
        <span class="sla">Frame Rate</span>
        <select class="sel" id="fpsSel"><option value="15">15 FPS</option><option value="30">30 FPS</option><option value="60">60 FPS</option></select>
      </div>
    </div>
    <div class="sec">
      <div class="sl">Connection</div>
      <button class="btn" id="disconnectBtn"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.36 6.64a9 9 0 1 1-12.73 0M12 2v10"/></svg><span>Disconnect</span></button>
    </div>
    <div class="sec">
      <div class="sl">Debug</div>
      <div class="tog" id="togS" tabindex="0"><div class="tl">Stats Overlay</div><div class="ts"></div></div>
      <div class="tog" id="togC" tabindex="0"><div class="tl">Console</div><div class="ts"></div></div>
    </div>
  </div>
</div>
<div class="stats" id="stats"><div id="sc"></div></div>
<div class="con" id="con"><div class="ch"><span class="ct">Console</span><button class="cc" id="conClr">Clear</button></div><div class="co" id="conOut"></div></div>
<script type="module" src="js/network.js"></script>
</body>
</html>
